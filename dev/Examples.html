<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · Microgrid_Genesys.jl</title><meta name="title" content="Examples · Microgrid_Genesys.jl"/><meta property="og:title" content="Examples · Microgrid_Genesys.jl"/><meta property="twitter:title" content="Examples · Microgrid_Genesys.jl"/><meta name="description" content="Documentation for Microgrid_Genesys.jl."/><meta property="og:description" content="Documentation for Microgrid_Genesys.jl."/><meta property="twitter:description" content="Documentation for Microgrid_Genesys.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="Microgrid_Genesys.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Microgrid_Genesys.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Microgrid_Genesys.jl</a></li><li class="is-active"><a class="tocitem" href="Examples.html">Examples</a><ul class="internal"><li><a class="tocitem" href="#Table-of-Contents"><span>Table of Contents</span></a></li><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Generating-Data-Scenarios"><span>Generating Data Scenarios</span></a></li><li><a class="tocitem" href="#Optimizing-and-Simulating-the-Microgrid"><span>Optimizing and Simulating the Microgrid</span></a></li><li><a class="tocitem" href="#Simulating"><span>Simulating</span></a></li><li><a class="tocitem" href="#Extracting-Metrics-and-Figures"><span>Extracting Metrics and Figures</span></a></li></ul></li><li><a class="tocitem" href="Scenario.html">Scenario</a></li><li><a class="tocitem" href="Tutorials/1-Introduction.html">Tutorials</a></li><li><a class="tocitem" href="Tutorials/2-Operation_data.html">Operation and Input data</a></li><li><a class="tocitem" href="Tutorials/3-Component.html">Component model and data structures</a></li><li><a class="tocitem" href="assets.html">Assets</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="Examples.html">Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="Examples.html">Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Cboennec/Microgrid_Genesys" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Cboennec/Microgrid_Genesys/blob/main/docs/src/Examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Table-of-Contents"><a class="docs-heading-anchor" href="#Table-of-Contents">Table of Contents</a><a id="Table-of-Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Table-of-Contents" title="Permalink"></a></h2><ol><li><a href="Examples.html#introduction">Introduction</a></li><li><a href="Examples.html#generating-data-scenarios">Generating Data Scenarios</a></li><li><a href="Examples.html#optimizing-and-simulating-the-microgrid">Optimizing and Simulating the Microgrid</a></li><li><a href="Examples.html#extracting-metrics-and-figures">Extracting Metrics and Figures</a></li></ol><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>This page provides example code snippets on how to use the main functionalities of our Julia package for modeling, optimizing and simulating microgrids. This package is designed to make it easy for users to design and analyze microgrid systems. The examples provided in this document cover the following key features:</p><ul><li>Generating data scenarios for simulation</li><li>Optimizing and simulating the microgrid</li><li>Extracting metrics and figures</li></ul><h2 id="Generating-Data-Scenarios"><a class="docs-heading-anchor" href="#Generating-Data-Scenarios">Generating Data Scenarios</a><a id="Generating-Data-Scenarios-1"></a><a class="docs-heading-anchor-permalink" href="#Generating-Data-Scenarios" title="Permalink"></a></h2><p>In this section, we provide examples of how to generate data scenarios for the simulation of your microgrid system. These data scenarios will be used as input for the optimization and simulation processes.</p><p>We here present two ways of generating scenarios :  A first way is to take directly the data from the Ausgrid dataset and for each client, each year create a scenario.  A second way is to build profils using a stochastic process detailed in <a href="https://hal.science/hal-03796717/document">this article</a>.</p><h3 id="Deterministic-generation"><a class="docs-heading-anchor" href="#Deterministic-generation">Deterministic generation</a><a id="Deterministic-generation-1"></a><a class="docs-heading-anchor-permalink" href="#Deterministic-generation" title="Permalink"></a></h3><pre><code class="language-julia hljs"> # Import necessary libraries
using JLD, Dates, Seaborn

# Include supplementary functions
include(&quot;functions.jl&quot;)

# Define global constants
# nh: number of hours in a year
# ny: number of years to simulate
# ns: number of scenarios to generate
const nh, ny, ns = 8760, 2, 60

# Load data for Ausgrid network for the years 2010, 2011, 2012
data_2010 = load(joinpath(&quot;Examples&quot;,&quot;build_scenarios&quot;, &quot;data&quot;, &quot;clean_dataset_ausgrid_2010_2011.jld&quot;), &quot;clean_dataset&quot;)
data_2011 = load(joinpath(&quot;Examples&quot;,&quot;build_scenarios&quot;, &quot;data&quot;, &quot;clean_dataset_ausgrid_2011_2012.jld&quot;), &quot;clean_dataset&quot;)
data_2012 = load(joinpath(&quot;Examples&quot;,&quot;build_scenarios&quot;, &quot;data&quot;, &quot;clean_dataset_ausgrid_2012_2013.jld&quot;), &quot;clean_dataset&quot;)

# Identify customers who have data for all three years
customers = [k for k in keys(data_2010) if k in keys(data_2011) &amp;&amp; k in keys(data_2012)]

# Initialize empty arrays for Photovoltaic (PV) production, Electric Load (ld_E) and Heat Load (ld_H)
_pv, _ld_E, _ld_H = [], [], []

# Set up date format to be used
dateformat = Dates.DateFormat(&quot;dd-u-yyyy&quot;)

# Loop over each customer and collect their data for all three years
for c in customers[1:20]
    # Collect and format data for Electric Load
    push!(_ld_E, (t = hcat(Dates.DateTime.(data_2010[c][&quot;GC&quot;][&quot;time&quot;][1:nh], dateformat), Dates.DateTime.(data_2011[c][&quot;GC&quot;][&quot;time&quot;][1:nh], dateformat), Dates.DateTime.(data_2012[c][&quot;GC&quot;][&quot;time&quot;][1:nh], dateformat)),
            power = hcat(data_2010[c][&quot;GC&quot;][&quot;power&quot;][1:nh], data_2011[c][&quot;GC&quot;][&quot;power&quot;][1:nh], data_2012[c][&quot;GC&quot;][&quot;power&quot;][1:nh])))

    # Collect and format data for Heat Load
    push!(_ld_H, (t = hcat(Dates.DateTime.(data_2010[c][&quot;CL&quot;][&quot;time&quot;][1:nh], dateformat), Dates.DateTime.(data_2011[c][&quot;CL&quot;][&quot;time&quot;][1:nh], dateformat), Dates.DateTime.(data_2012[c][&quot;CL&quot;][&quot;time&quot;][1:nh], dateformat)),
            power = hcat(data_2010[c][&quot;CL&quot;][&quot;power&quot;][1:nh], data_2011[c][&quot;CL&quot;][&quot;power&quot;][1:nh], data_2012[c][&quot;CL&quot;][&quot;power&quot;][1:nh])))

    # Collect and format data for PV Production
    push!(_pv, (t = hcat(Dates.DateTime.(data_2010[c][&quot;GG&quot;][&quot;time&quot;][1:nh], dateformat), Dates.DateTime.(data_2011[c][&quot;GG&quot;][&quot;time&quot;][1:nh], dateformat), Dates.DateTime.(data_2012[c][&quot;GG&quot;][&quot;time&quot;][1:nh], dateformat)),
            power = hcat(data_2010[c][&quot;GG&quot;][&quot;power&quot;][1:nh], data_2011[c][&quot;GG&quot;][&quot;power&quot;][1:nh], data_2012[c][&quot;GG&quot;][&quot;power&quot;][1:nh])))
end

# Format data to be compatible with Genesys simulation system
timestamp = repeat(reshape(hcat([p.tfor p in _pv]...), nh, 1, ns), 1, ny, 1)
pv = repeat(reshape(hcat([p.power for p in _pv]...), nh, 1, ns), 1, ny, 1)
ld_E = repeat(reshape(hcat([ld.power for ld in _ld_E]...), nh, 1, ns), 1, ny, 1)
ld_H = repeat(reshape(hcat([ld.power for ld in _ld_H]...), nh, 1, ns), 1, ny, 1)

# Define scenarios with costs
ω = Dict(
    &quot;pv&quot; =&gt; (t = timestamp, power = pv, cost = 1300 * ones(ny, ns)),  # Scenario for PV with timestamp, power and cost
    &quot;ld_E&quot; =&gt; (t = timestamp, power = ld_E),  # Scenario for Electric Load with timestamp and power
    &quot;ld_H&quot; =&gt; (t = timestamp, power = ld_H),  # Scenario for Heat Load with timestamp and power
    &quot;liion&quot; =&gt; (cost = 300 * ones(ny, ns),),  # Scenario for Lithium-ion batteries with cost
    &quot;tes&quot; =&gt; (cost = 10 * ones(ny, ns),),  # Scenario for Thermal Energy Storage with cost
    &quot;h2tank&quot; =&gt; (cost = 10 * ones(ny, ns),),  # Scenario for Hydrogen Storage Tank with cost
    &quot;elyz&quot; =&gt; (cost = 1300 * ones(ny, ns),),  # Scenario for Electrolyzer with cost
    &quot;fc&quot; =&gt; (cost = 1700 * ones(ny, ns),),  # Scenario for Fuel Cell with cost
    &quot;heater&quot; =&gt; (cost = 0 * ones(ny, ns),),  # Scenario for Heater with cost
    &quot;grid&quot; =&gt; (cost_in = 0.19 * ones(nh, ny, ns), cost_out = 0.0001 * ones(nh, ny, ns)),  # Scenario for Grid with cost_in and cost_out
)

# Save scenarios as .jld files
save(joinpath(&quot;data&quot;, &quot;ausgrid_deterministic.jld&quot;), &quot;ω&quot;, ω)</code></pre><h3 id="Stochastic-generation"><a class="docs-heading-anchor" href="#Stochastic-generation">Stochastic generation</a><a id="Stochastic-generation-1"></a><a class="docs-heading-anchor-permalink" href="#Stochastic-generation" title="Permalink"></a></h3><pre><code class="language-julia hljs">include(&quot;..\\src\\Genesys.jl&quot;)

using Main.Genesys
using Distributions, CSV, JLD, Dates, Seaborn, Statistics, ProgressMeter

# Global constants
const nh, ny, ns = 8760, 1, 2000

# Load data related to multiple clients over 3 years
data_2010 = load(joinpath(&quot;stage_scenario&quot;, &quot;data&quot;, &quot;clean_dataset_ausgrid_2010_2011.jld&quot;), &quot;clean_dataset&quot;)
data_2011 = load(joinpath(&quot;stage_scenario&quot;, &quot;data&quot;, &quot;clean_dataset_ausgrid_2011_2012.jld&quot;), &quot;clean_dataset&quot;)
data_2012 = load(joinpath(&quot;stage_scenario&quot;, &quot;data&quot;, &quot;clean_dataset_ausgrid_2012_2013.jld&quot;), &quot;clean_dataset&quot;)

# Find customers with 3 years of data
customers = [k for k in keys(data_2010) if k in keys(data_2011) &amp;&amp; k in keys(data_2012)]

# Initialize
dateformat = Dates.DateFormat(&quot;dd-u-yyyy&quot;)
_pv, _ld_E, _ld_H = [], [], []
s0 = [0., 0., 0.]
t0 = DateTime(2020,7,1,0)

# For each customer with 3 years of data, we use the data to create three time series (photovoltaic production, electric consumption, heat consumption)
# These time series are used to construct the states and probabilities of the Markov chains using the &quot;generator&quot;
# We then use this generator to produce a set of ns scenarios at an hourly timestep using &quot;generate&quot;
# The generated scenarios are stored in three lists (_pv, _ld_E, _ld_H)

@showprogress for c in custumers[1:20]
        # Retrieve the scenario
        ld_E = (t = hcat(Dates.DateTime.(data_2010[c][&quot;GC&quot;][&quot;time&quot;][1:nh], dateformat), Dates.DateTime.(data_2011[c][&quot;GC&quot;][&quot;time&quot;][1:nh], dateformat), Dates.DateTime.(data_2012[c][&quot;GC&quot;][&quot;time&quot;][1:nh], dateformat)),
                power = hcat(data_2010[c][&quot;GC&quot;][&quot;power&quot;][1:nh], data_2011[c][&quot;GC&quot;][&quot;power&quot;][1:nh], data_2012[c][&quot;GC&quot;][&quot;power&quot;][1:nh]))

        ld_H = (t = hcat(Dates.DateTime.(data_2010[c][&quot;CL&quot;][&quot;time&quot;][1:nh], dateformat), Dates.DateTime.(data_2011[c][&quot;CL&quot;][&quot;time&quot;][1:nh], dateformat), Dates.DateTime.(data_2012[c][&quot;CL&quot;][&quot;time&quot;][1:nh], dateformat)),
                power = hcat(data_2010[c][&quot;CL&quot;][&quot;power&quot;][1:nh], data_2011[c][&quot;CL&quot;][&quot;power&quot;][1:nh], data_2012[c][&quot;CL&quot;][&quot;power&quot;][1:nh]))

        pv = (t = hcat(Dates.DateTime.(data_2010[c][&quot;GG&quot;][&quot;time&quot;][1:nh], dateformat), Dates.DateTime.(data_2011[c][&quot;GG&quot;][&quot;time&quot;][1:nh], dateformat), Dates.DateTime.(data_2012[c][&quot;GG&quot;][&quot;time&quot;][1:nh], dateformat)),
                power = hcat(data_2010[c][&quot;GG&quot;][&quot;power&quot;][1:nh], data_2011[c][&quot;GG&quot;][&quot;power&quot;][1:nh], data_2012[c][&quot;GG&quot;][&quot;power&quot;][1:nh]))

        # Initialize generator
        generator = Genesys.initialize_generator!(MarkovGenerator(nstate = 20, algo = &quot;kmeans&quot;), pv, ld_E, ld_H)

        # Generate
        ω, proba = Genesys.generate(generator, s0, t0, nh, ny = ny, ns = ns)

        # Store
        push!(_pv, ω[1])
        push!(_ld_E, ω[2])
        push!(_ld_H, ω[3])
end

# After generating these time series, we will create scenarios for our case study
# First by aggregating the consumption data to create a case of 5 consumers
# Then by adding certain elements including pricing which will be necessary for our metrics
# Finally, we will store all these elements in two dictionaries, one for sizing and one for analysis (resp. optim, simu)
# These dictionaries will then be saved under the labels ω_optim and ω_simu


# Aggregation
# Randomly chose 5 among the 20 availables
idx = rand(1:20, 5, ns)
# Aggregate except for PV
pv = _pv[1]
ld_E = reshape(hcat([sum(ld[:,:,s] for ld in _ld_E[idx[:,s]]) for s in 1:ns]...), nh, ny, ns)
ld_H = reshape(hcat([sum(ld[:,:,s] for ld in _ld_H[idx[:,s]]) for s in 1:ns]...), nh, ny, ns)

# Add first year
timestamp = repeat(t0:Hour(1):t0+Hour(nh-1), 1, 2, ns)
pv = cat(pv[:,1,1] .* ones(nh,1,ns), pv, dims=2)
ld_E = cat(ld_E[:,1,1] .* ones(nh,1,ns), ld_E, dims=2)
ld_H = cat(ld_H[:,1,1] .* ones(nh,1,ns), ld_H, dims=2)

# Operating cost
# Flat rate including taxes, etc. - from eurostat - projected evolution over 20 years
_cost_in = compute_operating_cost_scenarios(0.19 * ones(nh), Normal(1.04, 0.04), nh, 20, ns)
_cost_out = compute_operating_cost_scenarios(0.0001 * ones(nh), Normal(1., 0.), nh, 20, ns)
# Averaged cost
cost_in = mean(_cost_in, dims=2)
cost_out = mean(_cost_out, dims=2)
# Add first year
cost_in = cat(0.19 * ones(nh, 1, ns), cost_in, dims=2)
cost_out = cat(0.0001 * ones(nh, 1, ns), cost_out, dims=2)

# Investment cost - from Petkov &amp; Gabrielli, 2020
cost_pv = 1300 * ones(2, ns)
cost_liion = 300 * ones(2, ns)
cost_tes = 10 * ones(2, ns)
cost_h2tank = 10 * ones(2, ns)
cost_elyz = 1300 * ones(2, ns)
cost_fc = 1700 * ones(2, ns)
cost_heater = 0 * ones(2, ns)

# Here we can devide the set of scenario in two keeping one half for sizing and one for assessing
# Scenarios
ω_optim = Dict(
&quot;pv&quot; =&gt; (t = timestamp[:,:,2:2:end], power = pv[:,:,2:2:end], cost = cost_pv[:,2:2:end]),
&quot;ld_E&quot; =&gt; (t = timestamp[:,:,2:2:end], power = ld_E[:,:,2:2:end]),
&quot;ld_H&quot; =&gt; (t = timestamp[:,:,2:2:end], power = ld_H[:,:,2:2:end]),
&quot;liion&quot; =&gt; (cost = cost_liion[:,2:2:end],),
&quot;tes&quot; =&gt; (cost = cost_tes[:,2:2:end],),
&quot;h2tank&quot; =&gt; (cost = cost_h2tank[:,2:2:end],),
&quot;elyz&quot; =&gt; (cost = cost_elyz[:,2:2:end],),
&quot;fc&quot; =&gt; (cost = cost_fc[:,2:2:end],),
&quot;heater&quot; =&gt; (cost = cost_heater[:,2:2:end],),
&quot;grid&quot; =&gt; (cost_in = cost_in[:,:,2:2:end], cost_out = cost_out[:,:,2:2:end]),
)

# ... and odd number scenarios for simulation
ω_simu = Dict(
&quot;pv&quot; =&gt; (t = timestamp[:,:,1:2:end], power = pv[:,:,1:2:end], cost = cost_pv[:,1:2:end]),
&quot;ld_E&quot; =&gt; (t = timestamp[:,:,1:2:end], power = ld_E[:,:,1:2:end]),
&quot;ld_H&quot; =&gt; (t = timestamp[:,:,1:2:end], power = ld_H[:,:,1:2:end]),
&quot;liion&quot; =&gt; (cost = cost_liion[:,1:2:end],),
&quot;tes&quot; =&gt; (cost = cost_tes[:,1:2:end],),
&quot;h2tank&quot; =&gt; (cost = cost_h2tank[:,1:2:end],),
&quot;elyz&quot; =&gt; (cost = cost_elyz[:,1:2:end],),
&quot;fc&quot; =&gt; (cost = cost_fc[:,1:2:end],),
&quot;heater&quot; =&gt; (cost = cost_heater[:,1:2:end],),
&quot;grid&quot; =&gt; (cost_in = cost_in[:,:,1:2:end], cost_out = cost_out[:,:,1:2:end]),
)

# Save scenarios as .jld files
save(joinpath(&quot;data&quot;, &quot;ausgrid_5_twostage.jld&quot;), &quot;ω_optim&quot;, ω_optim, &quot;ω_simu&quot;, ω_simu)</code></pre><p>For more information on  <code>initialize_generator</code> and  <code>generate</code> see <a href="Scenario.html">Scenario page</a></p><h2 id="Optimizing-and-Simulating-the-Microgrid"><a class="docs-heading-anchor" href="#Optimizing-and-Simulating-the-Microgrid">Optimizing and Simulating the Microgrid</a><a id="Optimizing-and-Simulating-the-Microgrid-1"></a><a class="docs-heading-anchor-permalink" href="#Optimizing-and-Simulating-the-Microgrid" title="Permalink"></a></h2><p>Once you have generated the data scenarios for your microgrid system, you can optimize and simulate its performance using the functions provided in our package. In this section, we demonstrate how to perform optimization and simulation using the data scenarios created in the previous section.</p><h3 id="Constructing-the-grid"><a class="docs-heading-anchor" href="#Constructing-the-grid">Constructing the grid</a><a id="Constructing-the-grid-1"></a><a class="docs-heading-anchor-permalink" href="#Constructing-the-grid" title="Permalink"></a></h3><p>The first step is to build the microgrid get the data and add assets to it. The following code show this process for the case of a single energy grid with battery storage and Solar panel over 21 years for 1 scenario. For more details about the assets see <a href="assets.html">Assets page</a></p><pre><code class="language-julia hljs">
using JLD, Dates

const nh, ny, ns = 8760, 21, 1 #nh = number of timestep per year, ny = time horizon (in years), ns = number of scenario used

data = load(joinpath(&quot;example&quot;,&quot;data&quot;,&quot;ausgrid_5_twostage.jld&quot;)) #Get the data for scenarios 

microgrid = Microgrid(parameters = GlobalParameters(nh, ny, ns, renewable_share = 1.)) # Instantiate a Microgrid 


add!(microgrid, Demand(carrier = Electricity()),
                Solar(),
                Liion_electro_chimique(),
                Grid(carrier = Electricity())) # Add assets to it

ω_d = Scenarios(microgrid, data[&quot;ω_optim&quot;]) # Build the right number of scenarios with the right length for the microgrid
</code></pre><p>It is also possible to get 2 set of scenarios as explained in section <a href="Examples.html#stochastic-generation">Stochastic generation</a> of this page. One for design and one for assessment.</p><pre><code class="language-julia hljs">ω_d, ω_a = Scenarios(microgrid, data[&quot;ω_optim&quot;]), Scenarios(microgrid, data[&quot;ω_simu&quot;])</code></pre><h3 id="Sizing-the-grid"><a class="docs-heading-anchor" href="#Sizing-the-grid">Sizing the grid</a><a id="Sizing-the-grid-1"></a><a class="docs-heading-anchor-permalink" href="#Sizing-the-grid" title="Permalink"></a></h3><p>The sizing is performed by a component called <code>designer</code>. Several type of designer are implemented and their role is to determine the size of the asset. The simplest designer is the manual one where the user chose mannually the size of the assets. Other designer use optimization to provide a size, different optimization methods are implemented, exact and stochastic ones.</p><p>Considering a grid <code>mg</code>, in order to determine the size of its assets, </p><p>one can use it&#39;s own design and use a <code>Manual</code> design.</p><pre><code class="language-julia hljs">PV_size = 20.
BAT_size = 40.                
designer = initialize_designer!(mg, Manual(generations = [PV_size], storages = [BAT_size], subscribed_power = [5.]), ω_d)</code></pre><p><code>Manual</code> design require a vector of values for the size of the generation assets, storage assets and grid assets.</p><p>Other design methods can be used with the following code. Here an example for the MILP designer</p><pre><code class="language-julia hljs">initialize_designer!(microgrid, MILP(options = MILPOptions(reducer = ManualReducer(y=1:1, s=1:1))), ω_d)</code></pre><p>Please note that the models used in the MILP formulation are linear models. Even if you added a more fine battery model.</p><h3 id="Operating-the-grid"><a class="docs-heading-anchor" href="#Operating-the-grid">Operating the grid</a><a id="Operating-the-grid-1"></a><a class="docs-heading-anchor-permalink" href="#Operating-the-grid" title="Permalink"></a></h3><p>To make the decisions during the simulation the grid need to be controlled. This role is taken by the <code>Controller</code>. A controller is going to operate the grid during the simulation, their is several type of controller implemented (Need to add reference or details) here. The simplest ones are Rule Based Controller <code>RBC</code>.  </p><pre><code class="language-julia hljs">controller = initialize_controller!(microgrid,  RBC(options = RBCOptions(policy_selection = 2 )), ω_d)</code></pre><p>More complexe controller using optimisation with varying range of sight can also be used.</p><pre><code class="language-julia hljs">controller = initialize_controller!(microgrid, Anticipative(generations = [10.], storages = [20.], converters = []), designer, ω_d)</code></pre><p>Please note that the models used in the MILP formulation are linear models. Even if you added a more fine battery model.</p><h2 id="Simulating"><a class="docs-heading-anchor" href="#Simulating">Simulating</a><a id="Simulating-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating" title="Permalink"></a></h2><p>Now that everything is declared the microgrid can be simulated to assess techno-economic indicators.</p><pre><code class="language-julia hljs">@time simulate!(microgrid, controller, designer, ω_a, options = Genesys.Options(mode = &quot;serial&quot;, firstyear = false))</code></pre><p>Here the microgrid will be simulated using the sizing stored in <code>desginer</code>, the operation stored in <code>controller</code> under the conditions of <code>ω_a</code>. The first year option can be use to compare a first year without any asset installed (as some kind of reference) to another year. </p><h2 id="Extracting-Metrics-and-Figures"><a class="docs-heading-anchor" href="#Extracting-Metrics-and-Figures">Extracting Metrics and Figures</a><a id="Extracting-Metrics-and-Figures-1"></a><a class="docs-heading-anchor-permalink" href="#Extracting-Metrics-and-Figures" title="Permalink"></a></h2><p>After optimizing and simulating your microgrid system, you may want to analyze its performance by extracting relevant metrics and creating visualizations. In this section, we provide examples of how to use our package to generate these metrics and figures.</p><pre><code class="language-julia hljs"> #Example code: Generating Metrics and Figures</code></pre><p>Once you have completed the examples in this document, you should be familiar with the main functionalities of our Julia package for modeling, optimizing, and simulating microgrids. If you have any questions or need further assistance, please refer to our package documentation or contact us for support.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="index.html">« Microgrid_Genesys.jl</a><a class="docs-footer-nextpage" href="Scenario.html">Scenario »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Monday 11 December 2023 10:30">Monday 11 December 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
